\chapter{Metodologia e Ferramentas}


\section{Sinais de Tempo Discreto e Transformada Discreta de \textit{Fourier}}

\section{Filtros Digitais}

	\subsection{Conceitos Iniciais}
	
		Os filtros digitais não contém uma implementação física em si, diferentemente dos filtros analógicos constituídos, geralmente, de associação de resistores e capacitores. Eles são construídos através de algoritmos.
		
		Para que isso possa ocorrer é necessário que o sinal de áudio (analógico) seja devidamente convertido em um sinal digital. esse sinal portanto convolui por um algoritmo de filtro adequado.
		
		De maneira geral, o projeto de um filtro consiste em obter os coeficientes para os filtros. Isso é realizado através de uma equação chamada de equação das diferenças. O processo pode ser simplesmente realizado pela equação (\ref{eq-filtro-bas}):
		
		\begin{equation}
			\text{Saida} = \sum_{1}^{n} \text{Coeficiente}_n \text{do filtro} * \text{Amostra}_n
			\label{eq-filtro-bas}
		\end{equation}
		
		Assim, o contexto de um filtro digital estará associado a equações de diferenças (ou funções de transferência no domínio Z) cujo parâmetros (coeficientes) serão calculados com o objetivo de discriminar (extrair, atenuar, etc.) determinadas componentes espectrais presentes em um sinal ou uma informação no mesmo sentido dos filtros analógicos, sem a necessidade de um circuito (\textit{hardware}) adicional. Em outras palavras, o filtro digital será uma rotina adicional agregada ao algoritmo responsável pela realização do sistema proposto em questão.
		
	\subsection{Filtros IIR}
		
		Os filtros digitais de resposta infinita ao impulso (\textit{Infinite Impulse Response - IIR}), também conhecidos como filtros recursivos ou autorregressivos, são modelados pela equação de diferença (\ref{eq1-iir}) ou pela função de transferência (\ref{eq2-iir-tf}), em que basicamente os valores dos coeficientes dos modelos define a natureza do filtro (passa-baixa; passa-alta; passa-faixa; rejeita-faixa).
		
		A denominação de IIR se deve que a saída do modelo decai para um valor nulo em um tempo infinito em resposta a um impulso aplicado na entrada filtro correspondente.
		
		\begin{equation}
			y(k) = \frac{1}{a_0}\left(\sum_{m=0}^{M}b_mx(k-m)-\sum_{n=1}^{N} a_ny(k-n)\right)
			\label{eq1-iir}
		\end{equation}
		
		\begin{equation}
			D(z) = \frac{y(z)}{x(z)} = \frac{b_0 + b_1z^{-1}+...+ b_mz^{-m}}{a_1z^{-1}+ a_nz^{-n}}
			\label{eq2-iir-tf}
		\end{equation}
		
		Resumidamente, a forma usual de calcular os coeficientes de um filtro digital IIR consiste em utilizar o modelo de um filtro analógico, e aplicar uma transformada Z via aproximação retangular ou trapezoidal \cite{Oppenhein1998}.
		
		Notoriamente, uma das vantagens na utilização dos filtros IIR é que eles resultam em comprimentos (quantidade de coeficientes) de filtro menor do que o filtro FIR correspondente, porém, esta melhoria é obtida às custas de distorção de fase e um transitório que não se limita a um intervalo de tempo finito \cite{Roberts1987}.
		
		
	\subsection{Filtros FIR}
		
		\begin{figure}[!htb]
			\centering
			\subfigure[\textbf{fluxo de sinais}]{
			\includegraphics[scale=0.5]{./figuras/FIR-diagrama-fluxo-sinais.png}
			\label{figura1-fir}}
			\qquad
			\subfigure[\textbf{diagrama de blocos}]{
			\includegraphics[scale=0.5]{./figuras/FIR-diagrama-blocos.png}
			\label{figura2-fir}}
			\caption{Diagrama de fluxo de sinais e diagrama de blocos de um filtro FIR}
			\label{fig01}	
		\end{figure}
		
		O lóbulo principal da janela retangular tem aproximadamente a metade da largura do lóbulo principal da janela \textit{Hamming};
		
		Os lóbulos laterais da janela \textit{Hamming}, em relação ao lóbulo principal, são muitos reduzidos em comparação com os da janela retangular. Especificamente, o pico de amplitude do primeiro lóbulo lateral da janela retangular está somente aproximadamente 13 dB abaixo do pico do lóbulo principal, ao passo que o valor correspondente para a janela \textit{Hamming} é de aproximadamente 40 dB.
		
		É devido a esta último ponto que a janela \textit{Hamming} reduz as oscilações na resposta em frequência de um filtro digital FIR. Todavia, há um preço a ser pago por esta melhoria, a saber, uma faixa de transição mais larga no espectro do filtro.\cite{haykin2001sinais}
	
		Vantagens:
		\begin{itemize}
			\item Um filtro não recursivo como o filtro FIR é inerentemente estável. Conforme pode ser visto na função de transferência ela é especificada em termos do zeros apenas no plano-z. Logo não há grandes preocupações em termos da escolha dos coeficientes que possam causar instabilidade no sistema, posto que seu LGR encontra-se estritamente dentro do semi-plano esquerdo do domínio-z.
			\item O filtro FIR (resposta ao impulso) tem forma simétrica no seu espectro de frequência. Isso produz uma característica de fase linear ideal, ou seja, é equivalente a puramente um atraso temporal em todas as componentes de frequência passando pelo filtro. Em outras palavras, podemos dizer que o filtro FIR não tem \textit{distorção de fase}.
		\end{itemize}
	\cite{Lynn1998}
	
	\subsection{Filtros Adaptativos}
		Os filtros adaptativos são constituídos, geralmente, por estruturas FIR, em que os coeficientes dos modelos associados são modificados conforme um procedimento adaptativo. essa modalidade de filtro geralmente é empregada nos seguintes contextos (\textit{lista não exaustiva}):
		
		\begin{itemize}
			\item Como procedimento alternativo na obtenção de valores dos coeficientes de um determinado filtro FIR, em que padrões de entrada e saída conhecidos são utilizados para estabelecer os valores dos coeficientes do filtro em questão;
			\item Cancelamento ou redução de ecos/barulhos de um determinado ambiente;
			\item Na modelagem de sistemas dinâmicos; e
			\item Como modelagem básica de representações de redes neurais artificiais.
		\end{itemize}
	
		A equação () representa o modelo de um filtro FIR, em que $W_m(k)$ denota os valores dos coeficientes do filtro em um instante de tempo $k$. 
		
		\begin{equation}
			\label{eq1-filtroadap}
			y(k) = \sum_{m=0}^{M} W_m(k)x(k-m)
		\end{equation}
		
		A diferença ou erro $\epsilon(k)$ entre o valor de padrão desejado d(k) para a a resposta do filtro e a informação da saída atual $y(k)$ do modelo associado é expressa por:
		
		\begin{equation}
			\label{eq2-filtroadap}
			\epsilon(k) = d(k)- y(k)
		\end{equation}
		
		Basicamente para ajustar os valores dos coeficientes de um filtro adaptativo tipicamente utiliza o método do gradiente para essa finalidade (fonte....), sendo o critério da somatória do erro quadrático de $\epsilon_(k)$ frequentemente utilizado na etapa de adaptação.
		
		Vale salientar, que alguns sistemas de comunicação de voz utilizam filtros adaptativos com o objetivo de cancelar ou reduzir ecos ou barulhos do ambiente. Nesse contexto, foi pensado inicialmente a utilização desse modelo de filtro para o projeto. No entanto, será explicado mais a frente a não adoção desse modelo, bem como pela utilização de um filtro FIR típico.
		
	\subsection{Filtro Pente - \textit{Comb Filter}}
		Em termos práticos \textit{comb filter} ou “filtro pente” é uma versão atrasada do mesmo sinal, causando uma  interferência construtiva ou destrutiva
		
		\begin{figure}[hbt]
			\centering
			\includegraphics[scale=0.5]{./figuras/Comb_filter_feedback.png}
			\caption{Filtro Pente - \textit{Comb Filter} - Forma de Realimentação}
			\label{fig01-combfilter}
		\end{figure}
		
		Similarmente, a estrutura geral de um sistema de realimentação de um \textit{comb filter} pode ser mostrado na figura (\ref{fig01-combfilter}). Além disso pode ser descrito pela seguinte equação de diferenças (\ref{eq01-combfilter}):
				
		\begin{equation}
			\label{eq01-combfilter}
			y[n] = x[n] + \alpha y[n-K]
		\end{equation}
		
		Se rearranjarmos os termos da equação para que todos as variáveis em $y$ fiquem do mesmo lado da equação e, na sequência, aplicamos a transformada Z em ambos os membros, teremos:
		
		\begin{equation}
			\label{eq02-combfilter}
			(1-\alpha z^{-K})Y(z) = X(z)
		\end{equation}
		
		Finalmente temos a função de transferência (\ref{eq03-combfilter}) correspondente ao sistema:
		
		\begin{equation}
			\label{eq03-combfilter}
			H(z) = \frac{Y(z)}{X(z)} = \frac{1}{1-\alpha z^{-K}} = \frac{z^K}{z^K-\alpha}
		\end{equation}
		
		Uma das formas de estimar a resposta de magnitude em função do valor do tempo de delay $K$ e fator de atenuação/ganho $\alpha$ é expressar $ H(z) $ em termos de módulo $|H(K,\alpha)|$, bem como, de maneira conveniente, utilizando uma substituição $ z = \epsilon^{j\theta} $.
		
		\begin{equation}
			|H(K,\alpha,\theta)| = \frac{1}{\sqrt{(1+a^2) - 2\alpha \cos(\theta K)}}
		\end{equation}
		
		
		
		
		De maneira análoga o \textit{Comb Filter} também pode ser implementado no domínio do tempo. O diagrama de representação do sistema pode ser descrito pela equação ():
		
		\begin{equation}
			y(t) = x(t) + \alpha x(t-\tau)
			\label{eq05-combfilter}
		\end{equation}
		
		
		
\section{Conversão Digital Analógica}

\section{Conversão Analógica Digital}

\section{Comunicação Serial I2C}
	
\section{Ferramentas Computacionais}

	\subsection{\textit{Code Compose Studio}}
	
	\subsection{\textit{WinFilter}}
